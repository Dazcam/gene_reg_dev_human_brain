Bootstrap: docker
From: ubuntu:20.04

%post
    # Install R and python
    apt-get -y update && apt-get install -y r-base-core python3

    # Install required R packages
    R --slave -e 'if (install.packages("devtools")'
    R --slave -e 'if (install.packages("BiocManager")'
    R --slave -e 'if (install.packages("ComplexHeatmap")'
    R --slave -e 'if (install.packages("clustree")'
    R --slave -e 'if (install.packages("cowplot")'
    R --slave -e 'if (install.packages("argparser")'
    R --slave -e 'if (install.packages("tidyverse")'
    R --slave -e 'if (install.packages("pheatmap")'
    R --slave -e 'if (install.packages("rmarkdown")'
    R --slave -e 'if (install.packages("knitr")'     

    # snRNA-seq specific
    R --slave -e 'if (BiocManager::install.packages("SingleCellExperiment")'
    R --slave -e 'if (BiocManager::install.packages("scDblFinder")'
    R --slave -e 'if (BiocManager::install.packages("scater")'
    R --slave -e 'if (BiocManager::install.packages("scran")'
    R --slave -e 'if (BiocManager::install.packages("scran")'
    R --slave -e 'if (BiocManager::install.packages("DropletUtils")'
    R --slave -e 'if (BiocManager::install.packages("PCAtools")'
    R --slave -e 'if (install.packages("Seurat")' 


    # snATAC-seq specific
    R --slave -e 'if (BiocManager::install.packages("BSgenome.Hsapiens.UCSC.hg38")'    
    R --slave -e 'if (devtools::install_github("GreenleafLab/ArchR", ref="master", repos = BiocManager::repositories())
    R --slave -e "ArchR::installExtraPackages()"
                  
%runscript
    python3 -c 'print("Hello World! Hello from our custom Singularity image!")'

